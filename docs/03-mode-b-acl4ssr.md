<!-- docs/03-mode-b-acl4ssr.md -->
# 模式 B：统一 ACL4SSR（订阅前缀 ns/…）

← [返回 README](../README.md)  
← 上一篇：[模式 A：保留订阅原始结构](02-mode-a-preserve.md)  
→ 下一篇：[准备订阅片段 YAML & 导入流程](04-snippets-and-import.md)

> 模式 B 适合：你不想保留订阅自带的复杂 group/rules，所有端口统一走 ACL4SSR 的分流逻辑，只保留“默认/直连/拦截”三组模型。

---

## 1) 模式 B 的核心目标

- 不读取/合并订阅片段里的 `proxy-groups` 与 `rules`（只导入节点与 provider）
- 每个订阅端口使用自己的 `sub-rules: acl4ssr_<ns>`
- 每个订阅生成订阅前缀三组：
  - `ns/默认`
  - `ns/🎯 全球直连`
  - `ns/🛑 全球拦截`
- 默认端口（全局 rules）使用 ALL 级三组：
  - `ALL/默认`
  - `ALL/🎯 全球直连`
  - `ALL/🛑 全球拦截`

---

## 2) 订阅前缀三组结构（只用三个组完成分流）

对每个 ns：

- `ns/默认`
  - 远程订阅：`use: [ns]`
  - local：`proxies: [ns/节点...]`
- `ns/🎯 全球直连`：`[DIRECT, ns/默认]`
- `ns/🛑 全球拦截`：`[REJECT, DIRECT]`

ACL4SSR 规则只会落到这三者之一（默认/直连/拦截）。

---

## 3) ALL 级三组（默认端口用）

- `ALL/默认`：包含所有订阅的 `ns/默认`
- `ALL/🎯 全球直连`：`[DIRECT, ALL/默认]`
- `ALL/🛑 全球拦截`：`[REJECT, DIRECT]`

这样默认端口也能按 ACL4SSR 分流，并且出口聚合到 ALL/默认（可在一个地方切换哪个订阅作为默认出口）。

---

## 4) 模式 B 的优缺点

优点：
- 规则体系统一、易理解、易维护
- 订阅之间不会互相污染 group 名（全是 ns/ 前缀）
- 适合新手快速稳定地跑起来

缺点：
- 订阅自带的复杂分组树会被抛弃（因为你选择了“统一规则”）
- 如果你很依赖订阅自带“媒体/电报/微软/苹果”等细分策略组，需要回到模式 A 或自行扩展规则

---

下一篇：
→ [准备订阅片段 YAML & v2ray 链接导入流程](04-snippets-and-import.md)
